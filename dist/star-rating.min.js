/**!
 * Star Rating
 *
 * Version: 1.1.0
 * Author: Paul Ryley (http://geminilabs.io)
 * URL: https://github.com/geminilabs/star-rating.js
 * License: MIT
 */
!function(t,s,i,e){"use strict";var a=function(s,i){this.el=s,this.$el=t(s),this.options=i,this.metadata=this.$el.data("options"),this.stars=0};a.prototype={defaults:{clearable:!0,clickFn:null,initialText:"Click to Rate",showText:!0},init:function(){if("SELECT"===this.el.tagName){for(var s=0;s<this.el.length;s++)if(""!==this.el[s].value){if(isNaN(parseFloat(this.el[s].value))||!isFinite(this.el[s].value))return;this.stars++}if(!(this.stars<1||this.stars>10))return this.config=t.extend({},this.defaults,this.options,this.metadata),this.build(),this.$el.on("change",this.change.bind(this)),this.$wrap.on("mouseenter",this.enter.bind(this)),this.$wrap.on("mouseleave",this.leave.bind(this)),this.$wrap.on("click",this.select.bind(this)),this.current=this.el.options[this.el.selectedIndex].value,this.selected=this.current,this.width=this.wrap.offsetWidth,this.star=Math.round(this.width/this.stars),this.select(),this}},build:function(){var s={},i={};this.$el.wrap('<span class="gl-star-rating" data-star-rating/>').after('<span class="gl-star-rating-stars"/>'),this.wrap=this.el.nextSibling,this.$wrap=t(this.wrap),this.config.showText&&(this.$wrap.after('<span class="gl-star-rating-text"/>'),this.text=this.wrap.nextSibling);for(var e=0;e<this.el.length;e++)""!==this.el[e].value&&(i[this.el[e].value]=this.el[e].text);Object.keys(i).sort().forEach(function(t){s[t]=i[t]});for(var a in s)this.$wrap.append('<span data-value="'+a+'" data-text="'+s[a]+'"/>')},change:function(){this.show(this.el.options[this.el.selectedIndex].value)},clear:function(t){this.config.clearable&&(this.el.value="",this.selected="",this.show(0))},enter:function(){var t=this.wrap.getBoundingClientRect();this.$wrap.on("mousemove",this.move.bind(this)),this.offsetLeft=t.left+i.body.scrollLeft},getIndexFromPosition:function(t){return Math.min(Math.ceil(Math.max(t-this.offsetLeft,1)/this.star),this.stars)},leave:function(){this.$wrap.off("mousemove"),this.show(this.selected)},move:function(t){this.show(this.getIndexFromPosition(t.pageX))},select:function(t){var s=this.current;return t!==e&&(s=this.getIndexFromPosition(t.pageX),""!==this.current&&parseFloat(this.selected)===s)?void this.clear():(this.el.value=s,this.selected=s,this.show(s),void(t!==e&&"function"==typeof this.config.clickFn&&this.config.clickFn(this.selected)))},show:function(t){(t<0||""===t)&&(t=0),t>this.stars&&(t=this.stars),this.$wrap.removeClass("s"+10*this.current).addClass("s"+10*t),this.config.showText&&(this.text.textContent=t<1?this.config.initialText:this.wrap.childNodes[t-1].dataset.text),this.current=t}},a.defaults=a.prototype.defaults,t.fn.starrating=function(s){return this.each(function(){t.data(this,"plugin_starrating")||t.data(this,"plugin_starrating",new a(this,s).init())})},s.StarRating=a}(jQuery,window,document);